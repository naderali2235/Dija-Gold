<!-- Loading Screen -->
<div *ngIf="isLoading" class="loading-screen">
  <div class="d-flex justify-content-center align-items-center min-vh-100">
    <div class="text-center">
      <div class="spinner-border text-primary mb-3" role="status" style="width: 3rem; height: 3rem;">
        <span class="visually-hidden">Loading...</span>
      </div>
      <h5 class="text-primary">Loading Dija Gold POS...</h5>
      <p class="text-muted">Please wait while we prepare your system</p>
    </div>
  </div>
</div>

<!-- Main Application -->
<div *ngIf="!isLoading" class="app-container">
  
  <!-- Layout for authenticated users -->
  <div *ngIf="isAuthenticated && showLayout" class="app-layout">
    <app-header></app-header>
    <div class="app-body">
      <app-sidebar></app-sidebar>
      <main class="app-main">
        <div class="container-fluid py-3">
          <router-outlet></router-outlet>
          <footer class="dija-footer mt-4 p-3 rounded">
            <div class="container d-flex flex-column flex-md-row align-items-center justify-content-between gap-2">
              <div class="small">© {{ (new Date()).getFullYear() }} Dija Gold</div>
              <div class="small rtl text-end">
                <span class="me-2">العنوان:</span>
                <span>{{ (environment as any).brand?.contact?.address }}</span>
              </div>
            </div>
          </footer>
        </div>
      </main>
    </div>
  </div>

  <!-- Simple layout for auth pages -->
  <div *ngIf="!showLayout" class="auth-layout">
    <router-outlet></router-outlet>
  </div>

  <!-- Layout for authenticated users without sidebar (like POS) -->
  <div *ngIf="isAuthenticated && showLayout && isPosRoute()" class="pos-layout">
    <app-header [showSidebar]="false"></app-header>
    <main class="pos-main">
      <router-outlet></router-outlet>
    </main>
  </div>

</div>

<!-- Global Notifications -->
<app-notifications></app-notifications>

<!-- Global Loading Overlay -->
<div *ngIf="isLoading" class="loading-overlay">
  <div class="loading-content">
    <div class="spinner-border text-light" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>
</div>